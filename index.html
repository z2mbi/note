<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Perrito al centro con lluvia m√°gica</title>
<style>
html, body {
  margin: 0;
  height: 100%;
  background: #081c3a;
  overflow: hidden;
}

/* Fondo azul con destellos */
.background {
  position: fixed;
  inset: 0;
  background:
    radial-gradient(1200px 800px at 10% 20%, rgba(23, 78, 166, 0.55), transparent 60%),
    radial-gradient(900px 700px at 80% 30%, rgba(12, 58, 128, 0.6), transparent 65%),
    radial-gradient(700px 600px at 40% 80%, rgba(18, 82, 158, 0.5), transparent 65%),
    radial-gradient(600px 500px at 70% 70%, rgba(255, 95, 109, 0.15), transparent 70%),
    radial-gradient(500px 400px at 25% 55%, rgba(255, 156, 187, 0.12), transparent 75%),
    linear-gradient(180deg, #0a1e3f 0%, #06142b 100%);
  animation: drift 22s ease-in-out infinite alternate;
}
@keyframes drift {
  0% { transform: translateY(0); }
  100% { transform: translateY(-2%); }
}

/* Lluvia m√°gica m√°s visible */
.rain {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image:
    repeating-linear-gradient(transparent, transparent 18px, rgba(255,200,255,0.25) 19px),
    repeating-linear-gradient(transparent, transparent 28px, rgba(255,150,200,0.2) 29px);
  background-size: 200% 200%;
  animation: rainMove 1.5s linear infinite;
}
@keyframes rainMove {
  to { background-position: -50px 100%; }
}

.stage {
  position: relative;
  width: 100%;
  height: 100%;
}

.dog {
  position: absolute;
  font-size: clamp(40px, 8vmin, 80px);
  left: -10%;
  top: 45%;
  transform: translate(-50%, -50%);
  filter: drop-shadow(0 4px 10px rgba(0,0,0,0.4));
  animation: wagTail 0.5s ease-in-out infinite alternate;
}
@keyframes wagTail {
  0% { transform: translate(-50%, -50%) rotate(0deg); }
  100% { transform: translate(-50%, -50%) rotate(4deg); }
}

/* Mensaje centrado */
.thought {
  position: absolute;
  transform: translate(-50%, -50%);
  background: rgba(245, 248, 255, 0.9);
  color: #0a1a33;
  padding: 0.5rem 0.7rem;
  border-radius: 12px;
  border: 1px solid rgba(10, 26, 51, 0.35);
  font-size: clamp(12px, 2.8vmin, 16px);
  box-shadow: 0 1px 0.5px rgba(255,255,255,0.35) inset,
              0 6px 18px rgba(0, 0, 0, 0.22);
  opacity: 0;
  pointer-events: none;
  transition: opacity 600ms ease;
  cursor: pointer;
}
.thought.show {
  opacity: 1;
  pointer-events: auto;
}

/* Flechas centradas */
.arrows {
  position: absolute;
  transform: translate(-50%, -50%);
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s ease;
}
.arrow {
  position: absolute;
  font-size: 1.5rem;
  color: #fffa;
  animation: pulse 1s infinite alternate;
}
.arrow:nth-child(1) { top: -40px; left: 50%; transform: translateX(-50%); }
.arrow:nth-child(2) { bottom: -40px; left: 50%; transform: translateX(-50%); }
.arrow:nth-child(3) { left: -40px; top: 50%; transform: translateY(-50%); }
.arrow:nth-child(4) { right: -40px; top: 50%; transform: translateY(-50%); }
@keyframes pulse {
  0% { transform: scale(1); opacity: 0.7; }
  100% { transform: scale(1.3); opacity: 1; }
}
.arrows.show {
  opacity: 1;
}

/* Oscurecimiento */
.veil {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: radial-gradient(160vmax 130vmax at 50% 55%, rgba(10, 18, 28, 0.3), rgba(4, 8, 16, 0.7) 40%, rgba(0, 0, 0, 0.95) 100%);
  opacity: 0;
  transition: opacity 1800ms ease-in-out;
}
.veil.dark {
  opacity: 1;
}

/* Rebote al llegar */
@keyframes bounce {
  0%, 100% { transform: translate(-50%, -50%) translateY(0) rotate(4deg); }
  50% { transform: translate(-50%, -50%) translateY(-5px) rotate(4deg); }
}
</style>
</head>
<body>
<div class="background"></div>
<div class="rain"></div>

<div class="stage">
  <span class="dog" id="dog">üê∂</span>
  <button class="thought" id="thought">(t√≥came)</button>
  <div class="arrows" id="arrows">
    <span class="arrow">‚¨Ü</span>
    <span class="arrow">‚¨á</span>
    <span class="arrow">‚¨Ö</span>
    <span class="arrow">‚û°</span>
  </div>
</div>

<div class="veil" id="veil"></div>

<script>
const dog = document.getElementById('dog');
const thought = document.getElementById('thought');
const veil = document.getElementById('veil');
const arrows = document.getElementById('arrows');

let startTime = null;
const delay = 2000;
const duration = 5000;

function easeOutElastic(t) {
  const c4 = (2 * Math.PI) / 3;
  return t === 0 ? 0 :
         t === 1 ? 1 :
         Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * c4) + 1;
}

function animateDog(timestamp) {
  if (!startTime) startTime = timestamp;
  const elapsed = timestamp - startTime;

  if (elapsed < delay) {
    requestAnimationFrame(animateDog);
    return;
  }

  const tRaw = Math.min((elapsed - delay) / duration, 1);
  const t = easeOutElastic(tRaw);

  const vw = window.innerWidth;
  const vh = window.innerHeight;

  const startX = -0.15 * vw;
  const centerX = vw / 2;
  const x = startX + (centerX - startX) * t;

  const centerY = vh * 0.45;
  const spiral = Math.sin(t * Math.PI * 4) * 40 * (1 - t);
  const y = centerY + spiral;

  dog.style.left = `${x}px`;
  dog.style.top = `${y}px`;

  if (tRaw >= 1) {
    // Cambia animaci√≥n al llegar
    dog.style.animation = 'wagTail 0.5s ease-in-out infinite alternate, bounce 1s ease infinite';
    thought.style.left = `${centerX}px`;
    thought.style.top = `${centerY - 80}px`;
    thought.classList.add('show');
    arrows.style.left = `${centerX}px`;
    arrows.style.top = `${centerY}px`;
    arrows.classList.add('show');
  } else {
    requestAnimationFrame(animateDog);
  }
}

thought.addEventListener('click', () => {
  veil.classList.add('dark');
});

requestAnimationFrame(animateDog);
</script>
</body>
</html>
